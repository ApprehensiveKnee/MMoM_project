# --- log file ---

# 1. Initialization
units real
boundary p p p
atom_style molecular
neighbor 1 bin
neigh_modify delay 3 one 6000
pair_style hybrid lj/cut 14 sg 15 cb 30 # Fluid-fluid interactions have a cutoff of 15 Å, fluid-solid interactions have a cutoff of 30 Å
#kspace_style pppm 1.0e-4
# *--* C-C parameters *--*
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style harmonic
# *--* C-C parameters *--*


# 2. Read the graphite platelet data file
# 3. Define potentials parameters
read_data ../geometry/carbonPlatelets/simulation_data/test.data  extra/atom/types 1
Reading data file ...
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading atoms ...
  64 atoms
  reading velocities ...
  64 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  3 = max angles/atom
  scanning dihedrals ...
  8 = max dihedrals/atom
  scanning impropers ...
  2 = max impropers/atom
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading bonds ...
  80 bonds
  reading angles ...
  132 angles
  reading dihedrals ...
  218 dihedrals
  reading impropers ...
  36 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.011 seconds
include PARM.lammps

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#//     Filename: PARM.lammps
#//     File Type: LAMMPS input script
#//     Description: This script defines the parameters for the simulation of hydrogen absorption in graphite platelets.
#//     Author: Edoardo Cabiati
#//     Date: 2024-07-27
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

mass 2 2.016 # For now at least, in accordance with the paper by Wang and Johnson,
             # 1998, the hydrogen atoms are regarded as simple spherical atoms

# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
pair_coeff 1 1 lj/cut 0.066 3.4
bond_coeff 1 469 1.4
angle_coeff 1 63 120
dihedral_coeff 1 0 7.25 0 0
improper_coeff 1 5 180
special_bonds lj 0.0 0.0 0.5
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds
# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
variable alpha equal 1.713          #|
variable sigma equal 1.567          #|
variable gamma equal 0.00993        #|
variable c6 equal 12.14             #|      The parameters are all in atomic units, the conversion to kcal/mol
variable c8 equal 215.2             #|      is performed in the pair_sg.cpp file
variable c9 equal 143.1             #|
variable c10 equal 4813.9           #|
variable rc equal 8.321             #|
pair_coeff 2 2 sg ${alpha} ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} # H-H potentials
pair_coeff 2 2 sg 1.713 ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 
#pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 # H-H potentials
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////
# Parameters taken from the paper by Wang and Johnson, 1998
variable sigma_CC equal 3.43 # Å
variable sigma_HH equal 3.075 # Å
variable sigma_CH_geo equal sqrt(${sigma_CC}*${sigma_HH}) # Å
variable sigma_CH_geo equal sqrt(3.43*${sigma_HH}) 
variable sigma_CH_geo equal sqrt(3.43*3.075) 
variable sigma_CH_arit equal 0.5*(${sigma_CC}+${sigma_HH}) # Å
variable sigma_CH_arit equal 0.5*(3.43+${sigma_HH}) 
variable sigma_CH_arit equal 0.5*(3.43+3.075) 

variable P_par equal 0.57 # Å^3
variable P_perp equal 1.995 # Å^3
variable P_h equal 0.81 # Å^3
variable E_h equal 2.337e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol
variable E_c equal 1.39254e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol

variable epsilon equal 4*(5/11)*v_E_h*v_E_c*v_P_h*(v_P_par+v_P_perp/2)/(v_sigma_CH_geo^6*(v_E_h+v_E_c)) # kcal/mol
# The formula taken from paper by Wang and Johnson, 1998 to construct epsilon does not seem to be consistent with the
# results obtained from the LAMMPS simulation. We will be using the value of epsilon obtained from the simplified
# version of the CB potential as 12-6 lennard-jones potential, presented in the paper "Theoretical investigation of the
# effect of graphite interlayer spacing on hydrogen absorption" by Rachel S. Aga, C. L. Fu, Maja Krčmar, and James R. Morris.
variable epsilon_sub equal 4*0.085094 # kcal/mol
variable sigma equal 2.97 # Å

pair_coeff 1 2 cb ${epsilon_sub} ${sigma} ${P_par} ${P_perp} # C-H potential
pair_coeff 1 2 cb 0.340376 ${sigma} ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 0.57 ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 0.57 1.995 
#pair_coeff 1 2 lj/cut 0.3025 2.065
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////

# 4. Generate the initial hydrogen atoms
lattice sc 3
Lattice spacing in x,y,z = 3 3 3
create_atoms 2 box ratio 0.01 428795
Created 8 atoms
  using lattice units in orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  create_atoms CPU = 0.002 seconds
lattice none 1
# Print the number of hydrogen atoms to file and delete the overlapping hydrogen atoms generated
variable hydrogen atom "type==2"
group hydrogen dynamic all var hydrogen
dynamic group hydrogen defined
variable nH equal count(hydrogen)
fix myat1 all ave/time 100 10 1000 v_nH file simulation_data/hydrogenCount.data

group           C type 1
64 atoms in group C
group           H2 type 2
8 atoms in group H2
delete_atoms    overlap 4 H2 C
System init for delete_atoms ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  5 neighbor lists, perpetual/occasional/extra = 4 1 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin
      stencil: full/bin/3d
      bin: standard
  (2) pair lj/cut, perpetual, skip trim from (5)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair sg, perpetual, skip trim from (5)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (4) pair cb, perpetual, skip from (5)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (5) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Ignoring 'compress yes' for molecular system (src/delete_atoms.cpp:141)
Deleted 0 atoms, new total = 72
reset_atoms     id sort yes
Resetting atom IDs ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  4 neighbor lists, perpetual/occasional/extra = 4 0 0
  (1) pair lj/cut, perpetual, skip trim from (4)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (2) pair sg, perpetual, skip trim from (4)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair cb, perpetual, skip from (4)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (4) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.000 seconds

# Constrain carbon atoms
fix             myspr C spring/self 5

# 5. Equilibration step
thermo 1000
variable        T equal 298
velocity        all create ${T} 1234567 dist gaussian
velocity        all create 298 1234567 dist gaussian
#----------------------------------------------------------------
compute_modify thermo_temp dynamic yes
compute ctH2 H2 temp
compute_modify ctH2 dynamic yes
fix mynvt1 H2 nvt temp ${T} ${T} 0.1
fix mynvt1 H2 nvt temp 298 ${T} 0.1
fix mynvt1 H2 nvt temp 298 298 0.1
fix_modify mynvt1 temp ctH2
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
compute ctC C temp
fix mynvt2 C nvt temp ${T} ${T} 0.1
fix mynvt2 C nvt temp 298 ${T} 0.1
fix mynvt2 C nvt temp 298 298 0.1
fix_modify mynvt2 temp ctC
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
timestep 0.05
thermo_style custom step temp pe ke etotal press vol
#----------------------------------------------------------------
# fix             npt1 mob_atoms npt temp ${T} ${T} 200 iso 113 113 2000


# Fix the motion of the outer carbons

dump            test_dump all atom 100 simulation_data/test.lammpstrj

run 100000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282–-3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 13.31 | 13.52 | 13.96 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
         0   298            1818.394       63.067979      1881.462       135.64934      18750        
      1000   281.38702      1725.828       59.55205       1785.38        1000.5312      18750        
      2000   325.62193      1725.3224      68.913816      1794.2362     -757.30003      18750        
      3000   284.13133      1737.3864      60.132848      1797.5192     -159.17446      18750        
      4000   310.34726      1719.4747      65.681122      1785.1558      8.6254395      18750        
      5000   283.50675      1733.1439      60.000663      1793.1446      284.51807      18750        
      6000   261.74506      1737.5022      55.395074      1792.8972     -145.37047      18750        
      7000   244.93348      1725.8224      51.837114      1777.6595     -365.19195      18750        
      8000   263.07467      1721.3333      55.676469      1777.0098      326.66382      18750        
      9000   289.99383      1725.0149      61.373573      1786.3885     -31.142886      18750        
     10000   308.71124      1721.3113      65.334879      1786.6461      415.16161      18750        
     11000   279.68741      1717.1046      59.192348      1776.297       421.28121      18750        
     12000   310.63414      1735.4548      65.741838      1801.1967     -302.60412      18750        
     13000   309.21826      1720.9229      65.442183      1786.3651     -210.6382       18750        
     14000   297.92042      1713.6793      63.051137      1776.7304      222.22913      18750        
     15000   265.59283      1728.7782      56.209407      1784.9876      418.06675      18750        
     16000   261.04611      1726.6322      55.247149      1781.8793      287.02258      18750        
     17000   335.38712      1717.9489      70.980496      1788.9294      118.38754      18750        
     18000   294.29834      1732.0595      62.284568      1794.3441     -31.5929        18750        
     19000   268.15577      1716.0375      56.751821      1772.7893     -6.3277565      18750        
     20000   294.39648      1724.6433      62.305338      1786.9487      768.13084      18750        
     21000   247.86989      1722.521       52.458567      1774.9796     -811.01774      18750        
     22000   286.34097      1726.8659      60.600492      1787.4664      149.25696      18750        
     23000   261.94961      1718.9588      55.438364      1774.3971     -794.15311      18750        
     24000   279.23259      1725.7825      59.09609       1784.8786      767.96876      18750        
     25000   262.44079      1716.6698      55.542315      1772.2121     -322.0437       18750        
     26000   263.29488      1728.0505      55.723073      1783.7736      349.56635      18750        
     27000   265.03962      1745.7514      56.092327      1801.8437     -276.15142      18750        
     28000   270.93641      1722.231       57.340307      1779.5713     -139.74077      18750        
     29000   307.4752       1718.0099      65.073287      1783.0831      309.74396      18750        
     30000   329.03007      1726.6777      69.635107      1796.3128      0.078310007    18750        
     31000   325.96385      1720.0225      68.98618       1789.0086     -255.09235      18750        
     32000   313.38801      1720.0013      66.32466       1786.3259      729.15097      18750        
     33000   308.99375      1722.8455      65.394669      1788.2401     -1255.2503      18750        
     34000   308.88216      1721.7703      65.371051      1787.1414      592.04441      18750        
     35000   268.99829      1722.8055      56.930129      1779.7356     -41.714533      18750        
     36000   258.98526      1724.6517      54.810996      1779.4627      9.6248221      18750        
     37000   345.46223      1725.6033      73.112768      1798.716      -750.09362      18750        
     38000   272.90975      1736.3921      57.757942      1794.15       -167.90941      18750        
     39000   319.58904      1736.993       67.63703       1804.63       -430.95617      18750        
     40000   300.82241      1723.7734      63.665306      1787.4387      133.16104      18750        
     41000   338.56685      1730.5741      71.653446      1802.2276     -281.89187      18750        
     42000   341.19738      1722.5427      72.210164      1794.7528     -24.766899      18750        
     43000   260.31117      1716.9162      55.091609      1772.0078     -666.66574      18750        
     44000   331.83997      1717.9568      70.229786      1788.1866      582.42727      18750        
     45000   264.80231      1732.0012      56.042103      1788.0433     -579.93927      18750        
     46000   319.06094      1728.0336      67.525264      1795.5588     -513.51813      18750        
     47000   243.28185      1720.0491      51.487565      1771.5366      204.22238      18750        
     48000   307.56075      1727.5836      65.091393      1792.675      -116.34368      18750        
     49000   259.03102      1719.2829      54.820681      1774.1036     -41.899977      18750        
     50000   305.01838      1722.4177      64.553332      1786.9711     -183.50521      18750        
     51000   331.1858       1723.0353      70.091339      1793.1266     -287.29188      18750        
     52000   299.38044      1724.8358      63.360131      1788.1959      390.51667      18750        
     53000   262.06378      1729.6542      55.462527      1785.1167     -398.98397      18750        
     54000   279.45885      1724.9588      59.143975      1784.1027      167.52105      18750        
     55000   299.06489      1720.6029      63.293349      1783.8963     -311.17433      18750        
     56000   251.39771      1725.8025      53.205186      1779.0076      540.3254       18750        
     57000   307.81465      1721.1666      65.145128      1786.3117     -626.6327       18750        
     58000   346.52586      1729.5239      73.337871      1802.8618      548.97365      18750        
     59000   283.52863      1729.1374      60.005295      1789.1427     -12.275613      18750        
     60000   270.05303      1730.3569      57.153351      1787.5102     -268.83903      18750        
     61000   305.51032      1713.6273      64.657444      1778.2847      364.02599      18750        
     62000   342.35846      1724.5542      72.455893      1797.0101      223.1852       18750        
     63000   348.42841      1727.9479      73.740523      1801.6884      160.3156       18750        
     64000   298.57822      1723.3754      63.190351      1786.5657      5.988124       18750        
     65000   285.06503      1728.1157      60.330454      1788.4462      204.40549      18750        
     66000   338.90823      1725.8237      71.725695      1797.5494      272.50949      18750        
     67000   326.4303       1730.804       69.084896      1799.8889     -768.54524      18750        
     68000   292.41575      1727.8882      61.886141      1789.7743      130.96627      18750        
     69000   325.898        1744.5282      68.972243      1813.5004     -363.76716      18750        
     70000   325.72241      1732.7587      68.935081      1801.6938      26.208686      18750        
     71000   272.95249      1731.4476      57.766987      1789.2146      448.62599      18750        
     72000   267.86965      1720.0174      56.691267      1776.7087     -226.76418      18750        
     73000   277.8616       1717.6276      58.805938      1776.4335     -711.8236       18750        
     74000   292.26576      1730.5941      61.8544        1792.4485      554.96333      18750        
     75000   232.80599      1720.3305      49.270482      1769.601       142.48538      18750        
     76000   326.20054      1719.2732      69.036272      1788.3095      22.994538      18750        
     77000   284.70906      1725.5857      60.255117      1785.8408      36.16679       18750        
     78000   366.44996      1723.605       77.554558      1801.1595     -349.44201      18750        
     79000   308.47182      1732.298       65.284208      1797.5823      238.91625      18750        
     80000   309.36629      1736.7157      65.473513      1802.1893      123.42282      18750        
     81000   286.34604      1724.791       60.601563      1785.3926      176.68684      18750        
     82000   219.29849      1727.6273      46.411787      1774.0391     -277.2249       18750        
     83000   239.33711      1724.201       50.652711      1774.8538     -246.89313      18750        
     84000   267.10404      1727.6118      56.529234      1784.141       298.8204       18750        
     85000   311.17524      1722.8306      65.856354      1788.687      -20.643201      18750        
     86000   254.61303      1724.7961      53.885668      1778.6818      273.89282      18750        
     87000   273.2209       1728.5499      57.823793      1786.3737     -99.407576      18750        
     88000   274.02344      1723.8934      57.99364       1781.887      -258.62983      18750        
     89000   261.02751      1714.1072      55.243213      1769.3504      762.68392      18750        
     90000   257.92326      1728.5848      54.586237      1783.1711     -528.43135      18750        
     91000   325.05426      1723.889       68.793675      1792.6826      488.5202       18750        
     92000   286.10824      1723.5555      60.551236      1784.1067     -187.32567      18750        
     93000   331.12036      1739.6193      70.07749       1809.6968     -253.42802      18750        
     94000   273.67919      1735.3979      57.920783      1793.3186      198.95525      18750        
     95000   279.74696      1720.541       59.204952      1779.7459      482.96814      18750        
     96000   289.6678       1723.8827      61.304573      1785.1873     -7.7490323      18750        
     97000   252.75322      1724.6707      53.492063      1778.1628     -335.11507      18750        
     98000   291.08794      1724.5406      61.605128      1786.1458     -70.214187      18750        
     99000   273.17675      1720.3691      57.814449      1778.1836      3.0941987      18750        
    100000   312.69881      1728.4587      66.178798      1794.6375      223.87939      18750        
Loop time of 39.433 on 6 procs for 100000 steps with 72 atoms

Performance: 10.955 ns/day, 2.191 hours/ns, 2535.945 timesteps/s, 182.588 katom-step/s
90.5% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.8707     | 6.7378     | 11.714     | 102.5 | 17.09
Bond    | 0.02839    | 0.70624    | 1.4847     |  64.6 |  1.79
Neigh   | 0.069397   | 0.070332   | 0.070984   |   0.2 |  0.18
Comm    | 18.061     | 23.25      | 26.436     |  59.0 | 58.96
Output  | 0.065077   | 0.073915   | 0.096974   |   3.9 |  0.19
Modify  | 7.6107     | 7.8517     | 8.2213     |   9.4 | 19.91
Other   |            | 0.7427     |            |       |  1.88

Nlocal:             12 ave          23 max           0 min
Histogram: 2 0 0 0 0 1 1 0 1 1
Nghost:           1553 ave        1675 max        1363 min
Histogram: 2 0 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 10.444444
Neighbor list builds = 270
Dangerous builds = 0

# 6. Production step - GCMC
variable tfac equal 3.0/3.0
# variable xlo equal xlo+0.1
# variable xhi equal xhi-0.1
# variable ylo equal ylo+0.1
# variable yhi equal yhi-0.1
# variable zlo equal zlo+0.1
# variable zhi equal zhi-0.1
# region system block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
fix fgcmc H2 gcmc 100 100 0 2 65899 ${T} -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 #region system
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert 1 group H2     pressure 113 
run 40000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:544)
0 atoms in group FixGCMC:gcmc_exclusion_group:fgcmc
Per MPI rank memory allocation (min/avg/max) = 14.31 | 14.52 | 14.96 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
    100000   312.69881      1728.4587      66.178798      1794.6375      223.87939      18750        
    101000   278.05679      1722.4528      71.279764      1793.7326     -169.27344      18750        
    102000   268.00384      1720.8106      71.898167      1792.7088     -87.725472      18750        
    103000   277.42015      1720.2211      71.116563      1791.3377      458.88337      18750        
    104000   269.04461      1732.116       74.583292      1806.6993     -925.88124      18750        
    105000   300.3849       1724.5667      83.2713        1807.838       596.28548      18750        
    106000   304.10049      1728.6508      87.020716      1815.6715     -383.14107      18750        
    107000   334.38539      1716.5245      102.66415      1819.1886      82.653278      18750        
    108000   264.04057      1726.8025      71.621986      1798.4245     -365.09873      18750        
    109000   275.84841      1718.7677      77.291662      1796.0593      352.66994      18750        
    110000   305.17259      1713.802       78.230891      1792.0329     -77.623808      18750        
    111000   298.79561      1716.7569      75.7055        1792.4624     -106.30196      18750        
    112000   297.63273      1704.2259      80.733984      1784.9598      257.02541      18750        
    113000   263.65866      1717.5006      76.233889      1793.7345     -574.14319      18750        
    114000   283.06615      1716.0166      70.032614      1786.0492      206.20661      18750        
    115000   313.68787      1727.6563      86.959087      1814.6154      322.15919      18750        
    116000   278.20573      1714.9616      79.610729      1794.5723     -266.59487      18750        
    117000   323.95586      1725.7535      93.668137      1819.4216      0.66140538     18750        
    118000   265.88932      1728.6833      75.293727      1803.9771      17.222058      18750        
    119000   266.2865       1720.5316      82.549947      1803.0816     -333.08766      18750        
    120000   284.98281      1720.9393      83.249003      1804.1883      402.35863      18750        
    121000   311.29799      1729.8129      87.224497      1817.0374     -175.06752      18750        
    122000   260.62224      1719.6726      70.694752      1790.3673      388.45017      18750        
    123000   283.61643      1728.2866      76.932011      1805.2186      36.776193      18750        
    124000   315.52326      1724.8405      83.705826      1808.5463      125.78106      18750        
    125000   275.66929      1732.8945      78.884908      1811.7794      208.37199      18750        
    126000   347.85352      1731.8914      98.5041        1830.3955     -381.14342      18750        
    127000   305.04386      1723.7217      78.197892      1801.9196      230.89464      18750        
    128000   306.97222      1717.968       83.267354      1801.2354      54.686434      18750        
    129000   282.79271      1720.0418      80.923331      1800.9651      139.64093      18750        
    130000   303.49451      1722.05        82.324013      1804.3741      305.24748      18750        
    131000   264.40514      1716.5605      70.144593      1786.7051     -679.88765      18750        
    132000   321.42077      1733.4039      91.018955      1824.4229     -162.96683      18750        
    133000   299.59848      1715.5579      83.946338      1799.5043      343.79845      18750        
    134000   285.51102      1723.6121      78.296978      1801.909      -415.01258      18750        
    135000   288.83663      1729.0044      76.626074      1805.6305      342.78747      18750        
    136000   327.21769      1717.4786      88.759013      1806.2377     -137.05166      18750        
    137000   320.27142      1710.8537      89.738818      1800.5925      14.67784       18750        
    138000   242.31909      1719.6493      67.896875      1787.5462     -15.433241      18750        
    139000   307.99867      1726.8211      78.955357      1805.7764     -245.49915      18750        
    140000   335.06732      1716.7662      86.893168      1803.6593      153.3953       18750        
Loop time of 110.414 on 6 procs for 40000 steps with 88 atoms

Performance: 1.565 ns/day, 15.335 hours/ns, 362.274 timesteps/s, 31.880 katom-step/s
90.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.7551     | 9.9388     | 16.221     | 114.7 |  9.00
Bond    | 0.015536   | 0.28962    | 0.60844    |  40.9 |  0.26
Neigh   | 0.23505    | 0.23947    | 0.24354    |   0.6 |  0.22
Comm    | 14.012     | 20.414     | 25.814     |  82.3 | 18.49
Output  | 0.03654    | 0.041148   | 0.052756   |   2.7 |  0.04
Modify  | 79.031     | 79.096     | 79.175     |   0.6 | 71.64
Other   |            | 0.3948     |            |       |  0.36

Nlocal:        14.6667 ave          25 max           3 min
Histogram: 2 0 0 0 0 0 2 1 0 1
Nghost:        1920.83 ave        2054 max        1720 min
Histogram: 2 0 0 0 0 0 0 1 1 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 8.5454545
Neighbor list builds = 40800
Dangerous builds = 0
# After the number of hydrogen atoms has been equilibrated,
# compute density profile for the hydrogen atoms along the absorbate direction
compute cc1 H2 chunk/atom bin/1d z 0.0 0.1
fix 1 H2 ave/chunk 100 100 10000 cc1 density/mass norm all file simulation_data/density.profile

run 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 14.66 | 14.97 | 15.32 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
    140000   335.06732      1716.7662      86.893168      1803.6593      153.3953       18750        
    141000   340.59224      1728.419       93.40215       1821.8211     -404.05207      18750        
    142000   293.74737      1716.0751      82.30688       1798.3819      205.33726      18750        
    143000   312.88899      1719.7808      96.996915      1816.7777      159.80482      18750        
    144000   279.99475      1725.1848      78.45345       1803.6383     -330.72429      18750        
    145000   286.09081      1732.4137      78.455977      1810.8697      203.98371      18750        
    146000   315.34505      1727.3834      87.418484      1814.8019     -490.77808      18750        
    147000   294.67574      1726.8729      79.931888      1806.8047      117.83701      18750        
    148000   307.98535      1720.3171      87.214353      1807.5314      135.9279       18750        
    149000   276.00117      1727.8382      78.157172      1805.9954     -123.54494      18750        
    150000   313.73144      1726.5283      88.841514      1815.3698      95.580413      18750        
Loop time of 24.4012 on 6 procs for 10000 steps with 96 atoms

Performance: 1.770 ns/day, 13.556 hours/ns, 409.816 timesteps/s, 39.342 katom-step/s
91.3% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.1255     | 2.3239     | 3.8835     |  57.3 |  9.52
Bond    | 0.0027333  | 0.068152   | 0.14606    |  20.1 |  0.28
Neigh   | 0.046822   | 0.047133   | 0.047585   |   0.1 |  0.19
Comm    | 2.811      | 4.3934     | 5.6435     |  42.8 | 18.00
Output  | 0.0084307  | 0.0093117  | 0.012049   |   1.3 |  0.04
Modify  | 17.465     | 17.482     | 17.502     |   0.3 | 71.64
Other   |            | 0.07773    |            |       |  0.32

Nlocal:             16 ave          26 max           5 min
Histogram: 2 0 0 0 0 0 2 0 1 1
Nghost:           2127 ave        2247 max        1947 min
Histogram: 2 0 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 7.8333333
Neighbor list builds = 10200
Dangerous builds = 0


write_data     ensemble_test.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
write_dump     all atom simulation_data/ensemble_test.lammpstrj

Total wall time: 0:02:54
