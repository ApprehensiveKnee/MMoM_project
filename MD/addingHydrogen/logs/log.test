# --- log file ---

# 1. Initialization
units real
boundary p p p
atom_style molecular
neighbor 1 bin
neigh_modify delay 3 one 6000
pair_style hybrid lj/cut 14 sg 15 cb 30 # Fluid-fluid interactions have a cutoff of 15 Å, fluid-solid interactions have a cutoff of 30 Å
#kspace_style pppm 1.0e-4
# *--* C-C parameters *--*
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style harmonic
# *--* C-C parameters *--*


# 2. Read the graphite platelet data file
# 3. Define potentials parameters
read_data ../geometry/carbonPlatelets/simulation_data/test.data  extra/atom/types 1
Reading data file ...
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading atoms ...
  64 atoms
  reading velocities ...
  64 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  3 = max angles/atom
  scanning dihedrals ...
  8 = max dihedrals/atom
  scanning impropers ...
  2 = max impropers/atom
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading bonds ...
  80 bonds
  reading angles ...
  132 angles
  reading dihedrals ...
  218 dihedrals
  reading impropers ...
  36 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.007 seconds
  read_data CPU = 0.023 seconds
include PARM.lammps

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#//     Filename: PARM.lammps
#//     File Type: LAMMPS input script
#//     Description: This script defines the parameters for the simulation of hydrogen absorption in graphite platelets.
#//     Author: Edoardo Cabiati
#//     Date: 2024-07-27
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

mass 2 2.016 # For now at least, in accordance with the paper by Wang and Johnson,
             # 1998, the hydrogen atoms are regarded as simple spherical atoms

# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
pair_coeff 1 1 lj/cut 0.066 3.4
bond_coeff 1 469 1.4
angle_coeff 1 63 120
dihedral_coeff 1 0 7.25 0 0
improper_coeff 1 5 180
special_bonds lj 0.0 0.0 0.5
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.007 seconds
# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
variable alpha equal 1.713          #|
variable sigma equal 1.567          #|
variable gamma equal 0.00993        #|
variable c6 equal 12.14             #|      The parameters are all in atomic units, the conversion to kcal/mol
variable c8 equal 215.2             #|      is performed in the pair_sg.cpp file
variable c9 equal 143.1             #|
variable c10 equal 4813.9           #|
variable rc equal 8.321             #|
pair_coeff 2 2 sg ${alpha} ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} # H-H potentials
pair_coeff 2 2 sg 1.713 ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 
#pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 # H-H potentials
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////
# Parameters taken from the paper by Wang and Johnson, 1998
variable sigma_CC equal 3.43 # Å
variable sigma_HH equal 3.075 # Å
variable sigma_CH_geo equal sqrt(${sigma_CC}*${sigma_HH}) # Å
variable sigma_CH_geo equal sqrt(3.43*${sigma_HH}) 
variable sigma_CH_geo equal sqrt(3.43*3.075) 
variable sigma_CH_arit equal 0.5*(${sigma_CC}+${sigma_HH}) # Å
variable sigma_CH_arit equal 0.5*(3.43+${sigma_HH}) 
variable sigma_CH_arit equal 0.5*(3.43+3.075) 

variable P_par equal 0.57 # Å^3
variable P_perp equal 1.995 # Å^3
variable P_h equal 0.81 # Å^3
variable E_h equal 2.337e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol
variable E_c equal 1.39254e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol

variable epsilon equal 4*v_E_h*v_E_c*v_P_h*(v_P_par+v_P_perp/2)/(v_sigma_CH_geo^6*(v_E_h+v_E_c)) # kcal/mol
# The formula taken from paper by Wang and Johnson, 1998 to construct epsilon does not seem to be consistent with the
# results obtained from the LAMMPS simulation. We will be using the value of epsilon obtained from the simplified
# version of the CB potential as 12-6 lennard-jones potential, presented in the paper "Theoretical investigation of the
# effect of graphite interlayer spacing on hydrogen absorption" by Rachel S. Aga, C. L. Fu, Maja Krčmar, and James R. Morris.
variable epsilon_sub equal 4*0.085094 # kcal/mol
variable sigma equal 2.97 # Å

pair_coeff 1 2 cb ${epsilon_sub} ${sigma} ${P_par} ${P_perp} # C-H potential
pair_coeff 1 2 cb 0.340376 ${sigma} ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 0.57 ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 0.57 1.995 
#pair_coeff 1 2 lj/cut 0.3025 2.065
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////
# Change the box dimension
change_box all x final -15.0 15.0 y final -15.0 15.0 z final -15.0 15.0 units box
Changing box ...
  orthogonal box = (-15 -12.5 -15) to (15 12.5 15)
  orthogonal box = (-15 -15 -15) to (15 15 15)
  orthogonal box = (-15 -15 -15) to (15 15 15)
reset_atoms id sort yes
Resetting atom IDs ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  4 neighbor lists, perpetual/occasional/extra = 4 0 0
  (1) pair lj/cut, perpetual, skip trim from (4)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (2) pair sg, perpetual, skip trim from (4)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair cb, perpetual, skip from (4)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (4) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds

# 4. Generate the initial hydrogen atoms
lattice sc 3
Lattice spacing in x,y,z = 3 3 3
create_atoms 2 box ratio 0.01 428795
Created 10 atoms
  using lattice units in orthogonal box = (-15 -15 -15) to (15 15 15)
  create_atoms CPU = 0.013 seconds
lattice none 1
# Print the number of hydrogen atoms to file and delete the overlapping hydrogen atoms generated
variable hydrogen atom "type==2"
group hydrogen dynamic all var hydrogen
dynamic group hydrogen defined
variable nH equal count(hydrogen)
fix myat1 all ave/time 100 10 1000 v_nH file simulation_data/hydrogenCount.data

group           C type 1
64 atoms in group C
group           H2 type 2
10 atoms in group H2
delete_atoms    overlap 4 H2 C
System init for delete_atoms ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  5 neighbor lists, perpetual/occasional/extra = 4 1 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin
      stencil: full/bin/3d
      bin: standard
  (2) pair lj/cut, perpetual, skip trim from (5)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair sg, perpetual, skip trim from (5)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (4) pair cb, perpetual, skip from (5)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (5) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Ignoring 'compress yes' for molecular system (src/delete_atoms.cpp:141)
Deleted 0 atoms, new total = 74
reset_atoms     id sort yes
Resetting atom IDs ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  4 neighbor lists, perpetual/occasional/extra = 4 0 0
  (1) pair lj/cut, perpetual, skip trim from (4)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (2) pair sg, perpetual, skip trim from (4)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair cb, perpetual, skip from (4)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (4) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.000 seconds

# Constrain carbon atoms
fix             myspr C spring/self 5

# 5. Equilibration step
thermo 1000
variable        T equal 298
velocity        all create ${T} 1234567 dist gaussian
velocity        all create 298 1234567 dist gaussian
#----------------------------------------------------------------
compute_modify thermo_temp dynamic yes
compute ctH2 H2 temp
compute_modify ctH2 dynamic yes
fix mynvt1 H2 nvt temp ${T} ${T} 0.1
fix mynvt1 H2 nvt temp 298 ${T} 0.1
fix mynvt1 H2 nvt temp 298 298 0.1
fix_modify mynvt1 temp ctH2
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
compute ctC C temp
fix mynvt2 C nvt temp ${T} ${T} 0.1
fix mynvt2 C nvt temp 298 ${T} 0.1
fix mynvt2 C nvt temp 298 298 0.1
fix_modify mynvt2 temp ctC
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
timestep 0.05
thermo_style custom step temp pe ke etotal press vol
#----------------------------------------------------------------
# fix             npt1 mob_atoms npt temp ${T} ${T} 200 iso 113 113 2000


# Fix the motion of the outer carbons

dump            test_dump all atom 100 simulation_data/test.lammpstrj

run 100000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282–-3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 13.29 | 13.51 | 13.94 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
         0   298            1816.3761      64.844542      1881.2206      84.137648      27000        
      1000   278.97724      1740.7629      60.705206      1801.4681      1201.2921      27000        
      2000   338.36317      1727.0598      73.627534      1800.6874     -509.45938      27000        
      3000   319.76752      1741.5435      69.581135      1811.1246      399.48994      27000        
      4000   313.28515      1729.9514      68.170576      1798.122      -200.28983      27000        
      5000   296.90405      1731.718       64.606064      1796.3241      126.86863      27000        
      6000   332.62165      1743.0718      72.378184      1815.45       -111.38802      27000        
      7000   285.43428      1722.6431      62.110252      1784.7534     -241.94028      27000        
      8000   305.14442      1725.8196      66.399162      1792.2188      222.8812       27000        
      9000   260.56234      1731.5401      56.69814       1788.2383     -302.91465      27000        
     10000   317.02884      1737.8914      68.9852        1806.8766      467.88827      27000        
     11000   291.81549      1717.9755      63.498797      1781.4743     -36.219456      27000        
     12000   275.99045      1728.4717      60.055283      1788.527      -201.36592      27000        
     13000   268.41941      1735.4953      58.407832      1793.9032     -341.84872      27000        
     14000   280.98833      1727.5376      61.142818      1788.6804     -76.205964      27000        
     15000   312.41763      1737.897       67.981805      1805.8788      692.42295      27000        
     16000   301.24737      1720.9096      65.551166      1786.4608     -411.86213      27000        
     17000   283.68655      1714.1717      61.729947      1775.9017      110.38077      27000        
     18000   274.69102      1723.1946      59.772529      1782.9671      135.50793      27000        
     19000   253.86192      1725.5393      55.240133      1780.7794     -263.91068      27000        
     20000   268.10795      1726.2928      58.340058      1784.6329      319.03778      27000        
     21000   306.19516      1732.3145      66.627802      1798.9423     -374.22976      27000        
     22000   315.39398      1730.0747      68.629457      1798.7042     -201.53085      27000        
     23000   297.16926      1728.7598      64.663772      1793.4236      93.200188      27000        
     24000   310.14638      1721.218       67.487585      1788.7056     -249.78593      27000        
     25000   286.58767      1733.1903      62.361229      1795.5516     -392.02384      27000        
     26000   252.64554      1716.9744      54.975451      1771.9498     -72.865342      27000        
     27000   234.91605      1732.8711      51.117529      1783.9886     -379.33362      27000        
     28000   257.45908      1722.5666      56.022873      1778.5894     -16.817235      27000        
     29000   283.33665      1727.3157      61.65381       1788.9695     -63.053563      27000        
     30000   285.94195      1733.8272      62.220721      1796.0479     -176.68392      27000        
     31000   287.38572      1722.6813      62.534885      1785.2162      140.63627      27000        
     32000   243.02086      1722.5997      52.881128      1775.4808     -321.4602       27000        
     33000   293.04017      1724.1546      63.765288      1787.9199      241.03898      27000        
     34000   260.77744      1720.6408      56.744944      1777.3858     -181.40412      27000        
     35000   292.16563      1726.3628      63.574988      1789.9378     -40.693712      27000        
     36000   341.72712      1733.632       74.359526      1807.9915      284.20377      27000        
     37000   327.09483      1721.5892      71.175551      1792.7648     -526.71434      27000        
     38000   301.13957      1730.0991      65.527709      1795.6268      330.44107      27000        
     39000   304.4064       1718.9477      66.238568      1785.1863      448.27658      27000        
     40000   218.30648      1727.1605      47.503301      1774.6638     -768.88723      27000        
     41000   313.05998      1729.4661      68.12158       1797.5877      371.14454      27000        
     42000   312.63749      1722.6888      68.029648      1790.7185     -141.78225      27000        
     43000   312.14762      1724.633       67.923051      1792.556       496.38594      27000        
     44000   282.37813      1721.1363      61.445236      1782.5815      62.14827       27000        
     45000   251.10033      1718.8577      54.639214      1773.4969     -238.24274      27000        
     46000   295.95549      1726.027       64.399658      1790.4267      541.18615      27000        
     47000   295.68813      1719.0759      64.341482      1783.4174     -344.61442      27000        
     48000   276.42874      1722.8119      60.150653      1782.9625      509.2114       27000        
     49000   297.243        1723.3642      64.67982       1788.044      -172.54678      27000        
     50000   327.76519      1722.4669      71.32142       1793.7883      136.91562      27000        
     51000   320.02824      1732.8019      69.637868      1802.4397      31.437346      27000        
     52000   294.09872      1726.1612      63.995627      1790.1568     -522.22696      27000        
     53000   307.49292      1725.2733      66.910193      1792.1835      563.56266      27000        
     54000   291.83571      1715.6154      63.503198      1779.1186     -141.22138      27000        
     55000   286.9573       1721.7243      62.441661      1784.166      -240.18438      27000        
     56000   353.58463      1724.8731      76.93971       1801.8128      641.2156       27000        
     57000   283.82813      1722.4427      61.760756      1784.2035     -117.86227      27000        
     58000   292.60197      1723.7591      63.669936      1787.4291      94.048053      27000        
     59000   271.32541      1731.3287      59.040175      1790.3689     -64.60117       27000        
     60000   328.48249      1724.3391      71.477505      1795.8166     -179.59947      27000        
     61000   294.5439       1727.4176      64.092498      1791.5101      260.3845       27000        
     62000   280.9172       1730.6365      61.127339      1791.7639     -313.91269      27000        
     63000   300.35044      1716.042       65.355996      1781.398       29.94099       27000        
     64000   280.27168      1722.5385      60.986876      1783.5254      352.37239      27000        
     65000   307.6663       1721.6939      66.947921      1788.6418     -318.23165      27000        
     66000   321.05522      1731.8512      69.861337      1801.7125      5.8097479      27000        
     67000   320.72069      1726.5874      69.788545      1796.376       98.058491      27000        
     68000   254.18282      1732.5486      55.309961      1787.8586     -332.92645      27000        
     69000   276.55305      1719.0406      60.177703      1779.2183      327.09945      27000        
     70000   273.71935      1723.5084      59.561093      1783.0695     -158.67733      27000        
     71000   288.75189      1722.6782      62.832161      1785.5104      304.51495      27000        
     72000   311.23239      1724.4205      67.723898      1792.1444     -336.20843      27000        
     73000   284.85159      1728.9337      61.983459      1790.9171     -37.010134      27000        
     74000   270.62252      1720.1539      58.887226      1779.0411     -194.98442      27000        
     75000   247.80516      1725.9887      53.922188      1779.9109      0.69382467     27000        
     76000   272.05132      1731.4768      59.198131      1790.6749      145.56283      27000        
     77000   251.51644      1725.3317      54.729759      1780.0615     -244.05416      27000        
     78000   294.5048       1717.9055      64.083988      1781.9895      148.3085       27000        
     79000   274.22369      1723.5876      59.670836      1783.2584      177.85426      27000        
     80000   294.51035      1726.1673      64.085197      1790.2525     -395.58472      27000        
     81000   331.70328      1726.3015      72.178347      1798.4799      64.504471      27000        
     82000   303.04552      1718.0886      65.942442      1784.0311     -4.1709064      27000        
     83000   277.44496      1722.4307      60.371783      1782.8025      101.04858      27000        
     84000   327.51591      1725.8557      71.267179      1797.1228      257.67855      27000        
     85000   285.93381      1723.9222      62.218948      1786.1412      65.494874      27000        
     86000   300.08522      1719.0055      65.298283      1784.3038      97.667491      27000        
     87000   287.50142      1725.9325      62.560061      1788.4925      56.775852      27000        
     88000   261.49281      1729.1029      56.900609      1786.0035      134.03159      27000        
     89000   294.18923      1719.5683      64.015322      1783.5836     -170.96192      27000        
     90000   291.81643      1733.1471      63.499003      1796.6461      76.772072      27000        
     91000   292.39877      1724.7443      63.625719      1788.3701     -35.554367      27000        
     92000   305.00386      1726.982       66.368576      1793.3506     -197.07965      27000        
     93000   298.19567      1730.6928      64.88712       1795.5799     -270.33754      27000        
     94000   271.56051      1715.9844      59.091332      1775.0758      473.13203      27000        
     95000   232.74111      1718.8235      50.644265      1769.4677     -285.41389      27000        
     96000   320.48991      1717.4165      69.738326      1787.1548      83.811958      27000        
     97000   340.81282      1720.4687      74.160574      1794.6293      238.63071      27000        
     98000   306.98034      1718.3478      66.798656      1785.1464     -151.85581      27000        
     99000   284.4085       1723.5289      61.887043      1785.4159      393.83181      27000        
    100000   281.67786      1725.0124      61.292858      1786.3052     -315.73292      27000        
Loop time of 45.1185 on 6 procs for 100000 steps with 74 atoms

Performance: 9.575 ns/day, 2.507 hours/ns, 2216.385 timesteps/s, 164.013 katom-step/s
86.9% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.9932     | 6.4124     | 9.6785     |  87.4 | 14.21
Bond    | 0.027632   | 0.74729    | 1.5548     |  66.6 |  1.66
Neigh   | 0.097276   | 0.098102   | 0.099037   |   0.2 |  0.22
Comm    | 22.679     | 26.176     | 29.826     |  46.9 | 58.02
Output  | 0.088314   | 0.099887   | 0.1303     |   4.5 |  0.22
Modify  | 10.308     | 10.615     | 11.114     |  10.8 | 23.53
Other   |            | 0.9703     |            |       |  2.15

Nlocal:        12.3333 ave          23 max           0 min
Histogram: 2 0 0 0 0 1 0 1 1 1
Nghost:        1347.67 ave        1449 max        1169 min
Histogram: 1 1 0 0 0 0 0 1 0 3
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 10.162162
Neighbor list builds = 275
Dangerous builds = 0

# 6. Production step - GCMC
variable tfac equal 3.0/3.0
# variable xlo equal xlo+0.1
# variable xhi equal xhi-0.1
# variable ylo equal ylo+0.1
# variable yhi equal yhi-0.1
# variable zlo equal zlo+0.1
# variable zhi equal zhi-0.1
# region system block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
fix fgcmc H2 gcmc 100 100 0 2 65899 ${T} -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 #region system
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert 1 group H2     pressure 113 
run 40000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:544)
0 atoms in group FixGCMC:gcmc_exclusion_group:fgcmc
Per MPI rank memory allocation (min/avg/max) = 14.29 | 14.51 | 14.95 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
    100000   281.67786      1725.0124      61.292858      1786.3052     -315.73292      27000        
    101000   281.34214      1725.8835      79.669612      1805.5531      47.276475      27000        
    102000   363.06866      1716.8915      112.55283      1829.4443      409.78412      27000        
    103000   246.2917       1720.0208      77.81977       1797.8405     -465.63284      27000        
    104000   274.49205      1725.0994      85.0937        1810.1931      244.48817      27000        
    105000   289.4642       1723.1295      90.597969      1813.7274     -97.475364      27000        
    106000   297.33762      1721.1339      87.744388      1808.8783      59.306244      27000        
    107000   269.20797      1723.5633      92.28265       1815.846      -89.299007      27000        
    108000   305.02555      1724.9729      97.286885      1822.2598      140.47419      27000        
    109000   316.69702      1720.5257      100.06545      1820.5911      266.23173      27000        
    110000   276.61446      1724.4223      80.804447      1805.2268     -75.520421      27000        
    111000   303.6608       1733.0817      85.084586      1818.1662     -31.011489      27000        
    112000   323.63046      1725.2312      102.25618      1827.4874      98.149468      27000        
    113000   319.67808      1721.9862      107.67766      1829.6639     -304.74094      27000        
    114000   281.27103      1718.9988      77.972642      1796.9714     -35.239692      27000        
    115000   288.92261      1714.4182      88.706012      1803.1242      302.73876      27000        
    116000   273.52295      1720.2623      88.054554      1808.3169     -18.745165      27000        
    117000   301.26442      1722.5046      97.883308      1820.3879      247.3216       27000        
    118000   281.39512      1715.8534      93.10518       1808.9586      223.10615      27000        
    119000   311.99474      1723.8207      107.87966      1831.7004     -94.610692      27000        
    120000   303.48539      1707.494       104.03271      1811.5268      692.30963      27000        
    121000   248.75922      1709.6402      76.37491       1786.0151     -238.81391      27000        
    122000   368.29955      1710.6441      111.97876      1822.6229     -12.883238      27000        
    123000   299.00759      1717.129       97.150045      1814.279       251.77044      27000        
    124000   299.33915      1728.4689      90.119588      1818.5885     -142.15262      27000        
    125000   295.46287      1713.5071      92.475462      1805.9826     -43.320996      27000        
    126000   340.64189      1733.2183      108.6466       1841.8649     -42.597263      27000        
    127000   297.39462      1715.9214      94.853024      1810.7744     -140.36987      27000        
    128000   284.11423      1719.141       88.923507      1808.0645      269.41932      27000        
    129000   300.87332      1738.8892      96.859393      1835.7486      82.030385      27000        
    130000   310.62041      1731.3601      85.182841      1816.543       38.72297       27000        
    131000   283.23478      1716.319       84.426909      1800.7459     -172.54363      27000        
    132000   274.12346      1723.6176      85.796546      1809.4142     -269.21109      27000        
    133000   302.27625      1713.2228      100.01412      1813.237      -175.78866      27000        
    134000   305.938        1717.1128      90.282362      1807.3952      440.59671      27000        
    135000   282.26166      1726.7157      87.502312      1814.218      -377.82118      27000        
    136000   298.32801      1715.2631      85.368875      1800.632       379.75899      27000        
    137000   334.31221      1721.2198      99.652121      1820.8719      88.372141      27000        
    138000   251.25715      1726.7489      75.643935      1802.3929     -69.42579       27000        
    139000   242.69676      1728.6454      68.726129      1797.3715     -287.10957      27000        
    140000   304.72527      1720.8445      87.199503      1808.044       8.9144876      27000        
Loop time of 104.682 on 6 procs for 40000 steps with 97 atoms

Performance: 1.651 ns/day, 14.539 hours/ns, 382.111 timesteps/s, 37.065 katom-step/s
89.7% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.5942     | 9.7245     | 15.254     | 111.2 |  9.29
Bond    | 0.013987   | 0.28612    | 0.59307    |  40.3 |  0.27
Neigh   | 0.22411    | 0.22948    | 0.23502    |   1.1 |  0.22
Comm    | 12.94      | 18.626     | 23.957     |  83.2 | 17.79
Output  | 0.031549   | 0.036146   | 0.049702   |   3.3 |  0.03
Modify  | 75.3       | 75.363     | 75.443     |   0.6 | 71.99
Other   |            | 0.4163     |            |       |  0.40

Nlocal:        16.1667 ave          24 max           4 min
Histogram: 1 0 1 0 0 0 1 0 1 2
Nghost:         1806.5 ave        1924 max        1653 min
Histogram: 2 0 0 0 0 0 0 2 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 7.7525773
Neighbor list builds = 40800
Dangerous builds = 0
# After the number of hydrogen atoms has been equilibrated,
# compute density profile for the hydrogen atoms along the absorbate direction
compute cc1 H2 chunk/atom bin/1d z 0.0 0.1
fix 1 H2 ave/chunk 100 100 10000 cc1 density/mass norm all file simulation_data/density.profile

run 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 14.67 | 14.97 | 15.32 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
    140000   304.72527      1720.8445      87.199503      1808.044       8.9144876      27000        
    141000   328.23818      1721.2142      102.73364      1823.9479      527.97384      27000        
    142000   313.26598      1717.1065      98.981358      1816.0879      48.27654       27000        
    143000   231.89404      1721.9777      82.947849      1804.9256     -65.194437      27000        
    144000   296.01117      1718.2463      91.764718      1810.0111     -211.80221      27000        
    145000   299.61088      1727.2267      96.452977      1823.6796     -50.82599       27000        
    146000   287.03805      1725.0789      88.983015      1814.0619      20.262451      27000        
    147000   261.41487      1723.213       81.818948      1805.0319      14.717518      27000        
    148000   312.3779       1725.4554      94.976195      1820.4316     -159.0341       27000        
    149000   283.92965      1729.5564      89.712078      1819.2685      435.58529      27000        
    150000   331.96037      1726.3999      107.85668      1834.2566     -228.75025      27000        
Loop time of 22.5374 on 6 procs for 10000 steps with 110 atoms

Performance: 1.917 ns/day, 12.521 hours/ns, 443.707 timesteps/s, 48.808 katom-step/s
93.6% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.0094     | 2.256      | 3.6753     |  56.8 | 10.01
Bond    | 0.0023413  | 0.066278   | 0.1378     |  19.6 |  0.29
Neigh   | 0.048912   | 0.04933    | 0.049814   |   0.2 |  0.22
Comm    | 2.4584     | 3.9076     | 5.2015     |  44.5 | 17.34
Output  | 0.0074899  | 0.0083457  | 0.010235   |   1.0 |  0.04
Modify  | 16.172     | 16.183     | 16.201     |   0.3 | 71.81
Other   |            | 0.06648    |            |       |  0.29

Nlocal:        18.3333 ave          26 max           7 min
Histogram: 1 1 0 0 0 0 1 0 1 2
Nghost:        2041.33 ave        2153 max        1851 min
Histogram: 1 1 0 0 0 0 0 1 1 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 6.8363636
Neighbor list builds = 10200
Dangerous builds = 0


write_data     ensemble_test.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
write_dump     all atom simulation_data/ensemble_test.lammpstrj

Total wall time: 0:02:52
