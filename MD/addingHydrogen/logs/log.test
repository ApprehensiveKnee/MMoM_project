# --- log file ---

# 1. Initialization
units real
boundary p p p
atom_style molecular
neighbor 1 bin
neigh_modify delay 3 one 6000
pair_style hybrid lj/cut 14 sg 15 cb 30 # Fluid-fluid interactions have a cutoff of 15 Å, fluid-solid interactions have a cutoff of 30 Å
#kspace_style pppm 1.0e-4
# *--* C-C parameters *--*
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style harmonic
# *--* C-C parameters *--*


# 2. Read the graphite platelet data file
# 3. Define potentials parameters
read_data ../geometry/carbonPlatelets/simulation_data/test.data  extra/atom/types 1
Reading data file ...
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading atoms ...
  64 atoms
  reading velocities ...
  64 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  3 = max angles/atom
  scanning dihedrals ...
  8 = max dihedrals/atom
  scanning impropers ...
  2 = max impropers/atom
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading bonds ...
  80 bonds
  reading angles ...
  132 angles
  reading dihedrals ...
  218 dihedrals
  reading impropers ...
  36 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.012 seconds
include PARM.lammps

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#//     Filename: PARM.lammps
#//     File Type: LAMMPS input script
#//     Description: This script defines the parameters for the simulation of hydrogen absorption in graphite platelets.
#//     Author: Edoardo Cabiati
#//     Date: 2024-07-27
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

mass 2 2.016 # For now at least, in accordance with the paper by Wang and Johnson,
             # 1998, the hydrogen atoms are regarded as simple spherical atoms

# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
pair_coeff 1 1 lj/cut 0.066 3.4
bond_coeff 1 469 1.4
angle_coeff 1 63 120
dihedral_coeff 1 0 7.25 0 0
improper_coeff 1 5 180
special_bonds lj 0.0 0.0 0.5
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds
# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
variable alpha equal 1.713          #|
variable sigma equal 1.567          #|
variable gamma equal 0.00993        #|
variable c6 equal 12.14             #|      The parameters are all in atomic units, the conversion to kcal/mol
variable c8 equal 215.2             #|      is performed in the pair_sg.cpp file
variable c9 equal 143.1             #|
variable c10 equal 4813.9           #|
variable rc equal 8.321             #|
pair_coeff 2 2 sg ${alpha} ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} # H-H potentials
pair_coeff 2 2 sg 1.713 ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 
#pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 # H-H potentials
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////
# Parameters taken from the paper by Wang and Johnson, 1998
variable sigma_CC equal 3.43 # Å
variable sigma_HH equal 3.075 # Å
variable sigma_CH_geo equal sqrt(${sigma_CC}*${sigma_HH}) # Å
variable sigma_CH_geo equal sqrt(3.43*${sigma_HH}) 
variable sigma_CH_geo equal sqrt(3.43*3.075) 
variable sigma_CH_arit equal 0.5*(${sigma_CC}+${sigma_HH}) # Å
variable sigma_CH_arit equal 0.5*(3.43+${sigma_HH}) 
variable sigma_CH_arit equal 0.5*(3.43+3.075) 

variable P_par equal 0.57 # Å^3
variable P_perp equal 1.995 # Å^3
variable P_h equal 0.81 # Å^3
variable E_h equal 2.337e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol
variable E_c equal 1.39254e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol

variable epsilon_CB equal 4*v_E_h*v_E_c*v_P_h*(v_P_par+v_P_perp/2)/(v_sigma_CH_geo^6*(v_E_h+v_E_c)) # kcal/mol
# The following is a set of parameters taken from the paper "Theoretical investigation of the effect of graphite interlayer
# spacing on hydrogen absorption" by Rachel S. Aga, C. L. Fu, Maja Krčmar, and James R. Morris, where the CB potential is
# simplified into a 12-6 LJ potential 4*epsilon*⌊(sigma/r)^12 − (sigma/r)^6⌋ .
# variable epsilon equal 4*0.085094 # kcal/mol
# variable sigma equal 2.97 # Å

pair_coeff 1 2 cb ${epsilon_CB} ${sigma_CH_geo} ${P_par} ${P_perp} # C-H potential
pair_coeff 1 2 cb 0.750549668586509 ${sigma_CH_geo} ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.750549668586509 3.24765299870537 ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.750549668586509 3.24765299870537 0.57 ${P_perp} 
pair_coeff 1 2 cb 0.750549668586509 3.24765299870537 0.57 1.995 
#pair_coeff 1 2 lj/cut 0.3025 2.065
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////

# 4. Generate the initial hydrogen atoms
lattice sc 3
Lattice spacing in x,y,z = 3 3 3
create_atoms 2 box ratio 0.01 428795
Created 8 atoms
  using lattice units in orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  create_atoms CPU = 0.001 seconds
lattice none 1
# Print the number of hydrogen atoms to file and delete the overlapping hydrogen atoms generated
variable hydrogen atom "type==2"
group hydrogen dynamic all var hydrogen
dynamic group hydrogen defined
variable nH equal count(hydrogen)
fix myat1 all ave/time 100 10 1000 v_nH file simulation_data/hydrogen_counts/hydrogenCount_test.data

group           C type 1
64 atoms in group C
group           H2 type 2
8 atoms in group H2
delete_atoms    overlap 4 H2 C
System init for delete_atoms ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  5 neighbor lists, perpetual/occasional/extra = 4 1 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin
      stencil: full/bin/3d
      bin: standard
  (2) pair lj/cut, perpetual, skip trim from (5)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair sg, perpetual, skip trim from (5)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (4) pair cb, perpetual, skip from (5)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (5) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Ignoring 'compress yes' for molecular system (src/delete_atoms.cpp:141)
Deleted 0 atoms, new total = 72
reset_atoms     id sort yes
Resetting atom IDs ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  4 neighbor lists, perpetual/occasional/extra = 4 0 0
  (1) pair lj/cut, perpetual, skip trim from (4)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (2) pair sg, perpetual, skip trim from (4)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair cb, perpetual, skip from (4)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (4) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.000 seconds


# Constrain carbon atoms
fix             myspr C spring/self 5

# 5. Equilibration step
thermo 1000
variable        T equal 298
velocity        all create ${T} 1234567 dist gaussian
velocity        all create 298 1234567 dist gaussian
#----------------------------------------------------------------
compute_modify thermo_temp dynamic yes
compute ctH2 H2 temp
compute_modify ctH2 dynamic yes
fix mynvt1 H2 nvt temp ${T} ${T} 0.1
fix mynvt1 H2 nvt temp 298 ${T} 0.1
fix mynvt1 H2 nvt temp 298 298 0.1
fix_modify mynvt1 temp ctH2
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
compute ctC C temp
fix mynvt2 C nvt temp ${T} ${T} 0.1
fix mynvt2 C nvt temp 298 ${T} 0.1
fix mynvt2 C nvt temp 298 298 0.1
fix_modify mynvt2 temp ctC
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
timestep 0.05
thermo_style custom step temp pe ke etotal press vol
#----------------------------------------------------------------
# fix             npt1 mob_atoms npt temp ${T} ${T} 200 iso 113 113 2000


# Fix the motion of the outer carbons

dump            test_dump all atom 100 simulation_data/dumps/test.lammpstrj

run 100000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282–-3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 13.31 | 13.52 | 13.96 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
         0   298            1817.8412      63.067979      1880.9092      131.68855      18750        
      1000   332.83747      1725.1056      70.440895      1795.5465      1030.7485      18750        
      2000   305.50103      1724.2776      64.655479      1788.933      -759.00115      18750        
      3000   276.45616      1736.8861      58.508494      1795.3946     -187.88649      18750        
      4000   326.38978      1717.1627      69.076323      1786.2391      1.6490698      18750        
      5000   300.53344      1730.3004      63.60415       1793.9045      329.77515      18750        
      6000   338.21303      1732.0921      71.578565      1803.6707     -125.13484      18750        
      7000   311.4206       1721.876       65.908282      1787.7842     -365.64062      18750        
      8000   265.21971      1719.3782      56.13044       1775.5086      338.19251      18750        
      9000   292.8076       1720.8489      61.969073      1782.8179     -66.56106       18750        
     10000   314.40487      1716.0069      66.539864      1782.5467      521.57361      18750        
     11000   257.90057      1713.3126      54.581436      1767.894       251.38829      18750        
     12000   282.24329      1731.5248      59.733267      1791.2581     -280.04892      18750        
     13000   309.4781       1713.015       65.497176      1778.5122     -168.84273      18750        
     14000   294.35857      1708.4757      62.297316      1770.773       128.81004      18750        
     15000   338.26733      1718.5441      71.590056      1790.1342      452.91849      18750        
     16000   291.66631      1718.8985      61.727532      1780.626       396.40113      18750        
     17000   297.4993       1713.0108      62.962011      1775.9728     -92.841613      18750        
     18000   255.75021      1721.4561      54.126338      1775.5825      113.62124      18750        
     19000   237.48623      1705.1323      50.260996      1755.3933     -440.33546      18750        
     20000   274.27912      1716.7539      58.047751      1774.8016      637.98014      18750        
     21000   284.2259       1715.4655      60.152862      1775.6184     -1079.7599      18750        
     22000   265.84182      1715.0842      56.262101      1771.3463     -43.662307      18750        
     23000   286.14681      1722.9253      60.5594        1783.4847     -438.4511       18750        
     24000   283.45863      1724.9556      59.99048       1784.9461      753.29595      18750        
     25000   244.90808      1717.9675      51.831738      1769.7993     -750.0064       18750        
     26000   325.47921      1725.6482      68.88361       1794.5318      705.98351      18750        
     27000   293.07186      1721.4313      62.024999      1783.4563     -1240.601       18750        
     28000   276.73654      1728.3337      58.567833      1786.9016      516.25069      18750        
     29000   364.23419      1719.7046      77.085618      1796.7902     -89.133454      18750        
     30000   236.64645      1735.2417      50.083267      1785.325      -273.37542      18750        
     31000   286.79645      1732.6393      60.696888      1793.3362     -231.16176      18750        
     32000   332.14336      1730.1206      70.293995      1800.4146      313.14587      18750        
     33000   285.66356      1722.5944      60.457126      1783.0515     -745.58132      18750        
     34000   255.95517      1724.6076      54.169716      1778.7773      259.75159      18750        
     35000   368.67322      1721.0668      78.025083      1799.0919     -920.62574      18750        
     36000   289.17289      1730.9245      61.199832      1792.1243      472.73625      18750        
     37000   269.37972      1723.5179      57.010854      1780.5288     -830.79141      18750        
     38000   262.70835      1728.773       55.598943      1784.3719      51.327792      18750        
     39000   292.02336      1719.5389      61.803097      1781.342       212.55372      18750        
     40000   359.77858      1721.0457      76.142644      1797.1884     -429.45202      18750        
     41000   281.9574       1724.5891      59.672763      1784.2619     -381.6341       18750        
     42000   285.61748      1712.2046      60.447372      1772.652       255.44739      18750        
     43000   329.50716      1717.699       69.736076      1787.4351     -536.44829      18750        
     44000   299.71227      1719.0027      63.430359      1782.433       494.99506      18750        
     45000   307.63257      1721.1002      65.106593      1786.2068     -621.90005      18750        
     46000   267.45338      1723.5163      56.603168      1780.1195      56.053793      18750        
     47000   241.16626      1719.1754      51.039827      1770.2152     -302.51835      18750        
     48000   258.50187      1718.9747      54.708692      1773.6834     -416.52451      18750        
     49000   294.85167      1716.5734      62.401674      1778.9751      240.34787      18750        
     50000   245.21723      1705.6203      51.897164      1757.5175     -744.56967      18750        
     51000   290.51538      1717.2123      61.483952      1778.6962      634.53395      18750        
     52000   311.45495      1706.4577      65.915551      1772.3732     -41.328364      18750        
     53000   271.64426      1716.46        57.490115      1773.9501     -477.1984       18750        
     54000   263.63426      1712.0556      55.794898      1767.8505      265.01006      18750        
     55000   308.09543      1709.8737      65.204551      1775.0783     -671.93002      18750        
     56000   342.35161      1714.7005      72.454444      1787.1549      227.72641      18750        
     57000   292.09463      1717.4885      61.818181      1779.3067      1.7029751      18750        
     58000   295.83934      1706.0321      62.610703      1768.6428     -258.4086       18750        
     59000   272.64757      1709.3699      57.702455      1767.0724      486.44007      18750        
     60000   281.55234      1711.7142      59.587037      1771.3013     -334.44706      18750        
     61000   296.37773      1717.2487      62.724646      1779.9733      485.58362      18750        
     62000   338.45103      1710.1068      71.628935      1781.7358     -103.34916      18750        
     63000   243.69401      1718.7501      51.574795      1770.3249     -186.23114      18750        
     64000   313.67034      1717.4161      66.384412      1783.8005      328.359        18750        
     65000   277.69753      1713.9735      58.771215      1772.7447     -7.7533322      18750        
     66000   301.92913      1728.9847      63.899531      1792.8842      805.35432      18750        
     67000   269.63896      1715.1635      57.065719      1772.2292     -5.9438027      18750        
     68000   303.20863      1712.2359      64.17032       1776.4062     -649.18097      18750        
     69000   279.95258      1721.3564      59.248467      1780.6049      233.90007      18750        
     70000   307.39452      1710.1952      65.056212      1775.2514     -24.931082      18750        
     71000   331.77964      1716.9353      70.217018      1787.1523     -335.25943      18750        
     72000   257.34301      1703.6138      54.463434      1758.0773      358.40962      18750        
     73000   327.33673      1720.9427      69.276732      1790.2194     -696.3955       18750        
     74000   265.19347      1717.2294      56.124886      1773.3543      187.02423      18750        
     75000   373.21465      1703.0995      78.98622       1782.0857     -415.82748      18750        
     76000   300.68881      1711.3804      63.637031      1775.0175      244.80553      18750        
     77000   247.00016      1713.9197      52.274499      1766.1942      338.04249      18750        
     78000   295.35983      1715.7836      62.50922       1778.2928     -462.54093      18750        
     79000   267.92794      1720.8834      56.703603      1777.587       437.09118      18750        
     80000   317.68279      1711.8975      67.233597      1779.1311     -277.06328      18750        
     81000   269.48938      1716.7999      57.034062      1773.8339      94.176856      18750        
     82000   275.71168      1714.9272      58.350935      1773.2781      551.32922      18750        
     83000   264.10368      1719.666       55.894246      1775.5602     -699.32373      18750        
     84000   261.45455      1722.0378      55.333592      1777.3714      594.01508      18750        
     85000   272.45315      1722.8073      57.661308      1780.4686     -512.95165      18750        
     86000   332.60779      1708.3368      70.392286      1778.7291      59.515396      18750        
     87000   290.92049      1713.3693      61.56969       1774.939      -223.85975      18750        
     88000   319.64914      1715.606       67.649749      1783.2558     -72.176405      18750        
     89000   347.55741      1717.3979      73.556186      1790.9541     -242.28676      18750        
     90000   310.85643      1716.6902      65.788882      1782.4791     -124.65733      18750        
     91000   291.20164      1705.53        61.629192      1767.1592     -34.631004      18750        
     92000   268.39652      1715.003       56.802771      1771.8057     -285.51207      18750        
     93000   274.18936      1720.93        58.028753      1778.9587     -50.685866      18750        
     94000   309.91628      1720.6085      65.589911      1786.1984      67.710197      18750        
     95000   326.34993      1721.0463      69.067888      1790.1142     -281.20601      18750        
     96000   307.26604      1719.4641      65.029021      1784.4932     -809.55108      18750        
     97000   262.17943      1714.4458      55.487003      1769.9328      191.3416       18750        
     98000   283.63687      1705.0984      60.028203      1765.1266     -99.161326      18750        
     99000   318.88341      1711.1575      67.487693      1778.6452     -624.24456      18750        
    100000   270.45658      1704.1909      57.238758      1761.4297      846.92451      18750        
Loop time of 43.3426 on 6 procs for 100000 steps with 72 atoms

Performance: 9.967 ns/day, 2.408 hours/ns, 2307.199 timesteps/s, 166.118 katom-step/s
90.7% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.6948     | 6.9133     | 14.13      | 135.4 | 15.95
Bond    | 0.025116   | 0.73475    | 1.5572     |  66.2 |  1.70
Neigh   | 0.080469   | 0.081069   | 0.081846   |   0.2 |  0.19
Comm    | 18.77      | 26.195     | 29.717     |  72.9 | 60.44
Output  | 0.080396   | 0.089489   | 0.11077    |   3.4 |  0.21
Modify  | 8.2857     | 8.5248     | 8.9409     |   9.9 | 19.67
Other   |            | 0.8046     |            |       |  1.86

Nlocal:             12 ave          21 max           0 min
Histogram: 2 0 0 0 0 0 1 1 0 2
Nghost:         1524.5 ave        1621 max        1339 min
Histogram: 2 0 0 0 0 0 0 0 0 4
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 10.444444
Neighbor list builds = 274
Dangerous builds = 0

# 6. Production step - GCMC
variable tfac equal 3.0/3.0
# variable xlo equal xlo+0.1
# variable xhi equal xhi-0.1
# variable ylo equal ylo+0.1
# variable yhi equal yhi-0.1
# variable zlo equal zlo+0.1
# variable zhi equal zhi-0.1
# region system block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
fix fgcmc H2 gcmc 100 100 0 2 65899 ${T} -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 #region system
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert 1 group H2     pressure 113 
run 40000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:544)
0 atoms in group FixGCMC:gcmc_exclusion_group:fgcmc
Per MPI rank memory allocation (min/avg/max) = 14.31 | 14.52 | 14.96 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
    100000   270.45658      1704.1909      57.238758      1761.4297      846.92451      18750        
    101000   258.66084      1707.8036      77.101884      1784.9055     -1384.419       18750        
    102000   291.2466       1704.4954      85.946929      1790.4423      944.09902      18750        
    103000   286.10836      1696.3583      81.019295      1777.3776     -730.34366      18750        
    104000   316.34353      1686.0146      91.467118      1777.4817      331.19242      18750        
    105000   306.18146      1701.5079      93.092214      1794.6001     -290.64253      18750        
    106000   297.85687      1690.0226      86.121912      1776.1445      75.746027      18750        
    107000   320.91182      1687.8625      98.527449      1786.3899      321.16233      18750        
    108000   280.09334      1688.444       82.6556        1771.0996      2.9100581      18750        
    109000   276.1703       1699.823       83.144332      1782.9673      16.873826      18750        
    110000   264.92209      1706.0097      75.019832      1781.0295      391.30332      18750        
    111000   290.12379      1690.0613      83.021175      1773.0824     -390.99084      18750        
    112000   291.06676      1692.7128      84.158628      1776.8714      364.93348      18750        
    113000   306.70055      1694.0511      94.164255      1788.2154     -40.880081      18750        
    114000   307.06641      1697.4648      87.869438      1785.3343     -0.16552298     18750        
    115000   319.26839      1682.4838      94.216164      1776.7         358.3668       18750        
    116000   267.49926      1690.2827      78.939083      1769.2218     -291.99756      18750        
    117000   292.54694      1683.4021      86.330658      1769.7327      14.211531      18750        
    118000   268.54597      1691.6356      82.449906      1774.0855      248.32315      18750        
    119000   335.58827      1699.01        109.03541      1808.0454     -364.84632      18750        
    120000   284.37496      1704.0668      88.157446      1792.2243      506.29318      18750        
    121000   315.88169      1692.5718      96.983081      1789.5549     -669.24226      18750        
    122000   314.82571      1706.6629      93.843565      1800.5065      180.38134      18750        
    123000   339.09686      1702.323       96.024417      1798.3474     -125.83721      18750        
    124000   263.28781      1704.5666      76.911474      1781.478      -657.61669      18750        
    125000   308.49996      1696.0332      91.038398      1787.0716      800.28593      18750        
    126000   293.48686      1696.6166      88.357688      1784.9742     -573.29663      18750        
    127000   317.53869      1686.61        94.652251      1781.2623      883.45847      18750        
    128000   318.19175      1701.9265      97.692324      1799.6188     -322.86573      18750        
    129000   295.10897      1691.8089      88.846041      1780.655      -90.580767      18750        
    130000   327.23218      1705.1882      94.615445      1799.8036      225.4031       18750        
    131000   304.65524      1704.2904      89.903822      1794.1942     -692.27963      18750        
    132000   249.78428      1702.373       74.455949      1776.829      -62.637233      18750        
    133000   273.55247      1698.6231      85.617836      1784.2409      554.984        18750        
    134000   279.38974      1694.7216      79.949543      1774.6711     -832.20994      18750        
    135000   285.96608      1703.3579      80.979003      1784.3369      1094.5858      18750        
    136000   303.22759      1690.4137      87.674794      1778.0884     -1580.6771      18750        
    137000   284.577        1702.8451      77.192567      1780.0377      1024.9867      18750        
    138000   295.12026      1698.5189      89.729139      1788.2481     -969.04932      18750        
    139000   262.29961      1700.2182      75.840935      1776.0591      334.53805      18750        
    140000   345.06194      1690.6779      99.770716      1790.4486     -830.51502      18750        
Loop time of 138.043 on 6 procs for 40000 steps with 98 atoms

Performance: 1.252 ns/day, 19.173 hours/ns, 289.764 timesteps/s, 28.397 katom-step/s
90.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.5082     | 12.703     | 20.72      | 126.0 |  9.20
Bond    | 0.015302   | 0.3012     | 0.62906    |  41.5 |  0.22
Neigh   | 0.29031    | 0.29309    | 0.2956     |   0.3 |  0.21
Comm    | 17.699     | 25.871     | 32.313     |  91.1 | 18.74
Output  | 0.042764   | 0.047051   | 0.058978   |   2.5 |  0.03
Modify  | 98.302     | 98.354     | 98.401     |   0.3 | 71.25
Other   |            | 0.4744     |            |       |  0.34

Nlocal:        16.3333 ave          26 max           4 min
Histogram: 1 1 0 0 0 0 1 1 1 1
Nghost:         2161.5 ave        2296 max        1953 min
Histogram: 2 0 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 7.6734694
Neighbor list builds = 40800
Dangerous builds = 0
# After the number of hydrogen atoms has been equilibrated,
# compute density profile for the hydrogen atoms along the absorbate direction
compute cc1 H2 chunk/atom bin/1d z 0.0 0.1
fix 1 H2 ave/chunk 100 100 10000 cc1 density/mass norm all file simulation_data/density_profiles/density_test.profile

run 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 14.68 | 14.98 | 15.33 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
    140000   345.06194      1690.6779      99.770716      1790.4486     -830.51502      18750        
    141000   284.28461      1682.447       89.824233      1772.2713      327.46016      18750        
    142000   259.61421      1708.8363      73.516762      1782.3531      392.63335      18750        
    143000   300.20926      1697.7639      97.54048       1795.3044     -189.45207      18750        
    144000   281.23019      1709.2504      80.476203      1789.7266     -201.55608      18750        
    145000   289.46836      1704.6612      81.970769      1786.6319      639.69728      18750        
    146000   268.8249       1712.1499      78.528964      1790.6789     -576.28211      18750        
    147000   291.07197      1683.3977      88.498286      1771.896       533.94855      18750        
    148000   326.47184      1705.1941      95.368754      1800.5629     -123.92171      18750        
    149000   294.84845      1693.5607      90.525384      1784.0861      257.06847      18750        
    150000   335.59267      1698.0392      107.03617      1805.0754     -174.11638      18750        
Loop time of 30.3996 on 6 procs for 10000 steps with 108 atoms

Performance: 1.421 ns/day, 16.889 hours/ns, 328.952 timesteps/s, 35.527 katom-step/s
88.0% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.3715     | 2.9616     | 4.8048     |  62.1 |  9.74
Bond    | 0.0039511  | 0.073831   | 0.14642    |  20.0 |  0.24
Neigh   | 0.059476   | 0.060281   | 0.060948   |   0.3 |  0.20
Comm    | 3.7748     | 5.6521     | 7.3021     |  46.3 | 18.59
Output  | 0.0091954  | 0.010465   | 0.014773   |   1.9 |  0.03
Modify  | 21.511     | 21.525     | 21.534     |   0.2 | 70.81
Other   |            | 0.1162     |            |       |  0.38

Nlocal:             18 ave          25 max           5 min
Histogram: 1 1 0 0 0 0 0 0 1 3
Nghost:           2421 ave        2562 max        2203 min
Histogram: 2 0 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 6.962963
Neighbor list builds = 10200
Dangerous builds = 0


write_data     ensemble_test.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
write_dump     all atom simulation_data/dumps/ensemble_test.lammpstrj

Total wall time: 0:03:31
