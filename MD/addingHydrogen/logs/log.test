# --- log file ---

# 1. Initialization
units real
boundary p p p
atom_style molecular
neighbor 1 bin
neigh_modify delay 3 one 6000
pair_style hybrid lj/cut 14 sg 15 cb 30 # Fluid-fluid interactions have a cutoff of 15 Å, fluid-solid interactions have a cutoff of 30 Å
#kspace_style pppm 1.0e-4
# No space style is needed for the absence of charges
# *--* C-C parameters *--*
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style harmonic
# *--* C-C parameters *--*


# 2. Read the graphite platelet data file
# 3. Define potentials parameters
read_data ../geometry/carbonPlatelets/simulation_data/test.data  extra/atom/types 1
Reading data file ...
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading atoms ...
  64 atoms
  reading velocities ...
  64 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  3 = max angles/atom
  scanning dihedrals ...
  8 = max dihedrals/atom
  scanning impropers ...
  2 = max impropers/atom
  orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  1 by 2 by 3 MPI processor grid
  reading bonds ...
  80 bonds
  reading angles ...
  132 angles
  reading dihedrals ...
  218 dihedrals
  reading impropers ...
  36 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.009 seconds
include PARM.lammps

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#//     Filename: PARM.lammps
#//     File Type: LAMMPS input script
#//     Description: This script defines the parameters for the simulation of hydrogen absorption in graphite platelets.
#//     Author: Edoardo Cabiati
#//     Date: 2024-07-27
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

mass 2 2.016 # For now at least, in accordance with the paper by Wang and Johnson,
             # 1998, the hydrogen atoms are regarded as simple spherical atoms

# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
pair_coeff 1 1 lj/cut 0.066 3.4
bond_coeff 1 469 1.4
angle_coeff 1 63 120
dihedral_coeff 1 0 7.25 0 0
improper_coeff 1 5 180
special_bonds lj 0.0 0.0 0.5
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds
# //////////////////////////////////////    C-C potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
variable alpha equal 1.713          #|
variable sigma equal 1.567          #|
variable gamma equal 0.00993        #|
variable c6 equal 12.14             #|      The parameters are all in atomic units, the conversion to kcal/mol
variable c8 equal 215.2             #|      is performed in the pair_sg.cpp file
variable c9 equal 143.1             #|
variable c10 equal 4813.9           #|
variable rc equal 8.321             #|
pair_coeff 2 2 sg ${alpha} ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} # H-H potentials
pair_coeff 2 2 sg 1.713 ${sigma} ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 ${gamma} ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 ${c6} ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 ${c8} ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 ${c9} ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 ${c10} ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 ${rc} 
pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 
#pair_coeff 2 2 sg 1.713 1.567 0.00993 12.14 215.2 143.1 4813.9 8.321 # H-H potentials
# //////////////////////////////////////    H-H potentials    //////////////////////////////////////
# -------------------------------------------------------------------------------------------------
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////
# Parameters taken from the paper by Wang and Johnson, 1998
variable sigma_CC equal 3.43 # Å
variable sigma_HH equal 3.075 # Å
variable sigma_CH_geo equal sqrt(${sigma_CC}*${sigma_HH}) # Å
variable sigma_CH_geo equal sqrt(3.43*${sigma_HH}) 
variable sigma_CH_geo equal sqrt(3.43*3.075) 
variable sigma_CH_arit equal 0.5*(${sigma_CC}+${sigma_HH}) # Å
variable sigma_CH_arit equal 0.5*(3.43+${sigma_HH}) 
variable sigma_CH_arit equal 0.5*(3.43+3.075) 

variable P_par equal 0.57 # Å^3
variable P_perp equal 1.995 # Å^3
variable P_h equal 0.81 # Å^3
variable E_h equal 2.337e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol
variable E_c equal 1.39254e5*(1/503.23) # K * 1/503.23 kcal/mol/K = kcal/mol

variable epsilon equal 4*(5/11)*v_E_h*v_E_c*v_P_h*(v_P_par+v_P_perp/2)/(v_sigma_CH_geo^6*(v_E_h+v_E_c)) # kcal/mol
# The formula taken from paper by Wang and Johnson, 1998 to construct epsilon does not seem to be consistent with the
# results obtained from the LAMMPS simulation. We will be using the value of epsilon obtained from the simplified
# version of the CB potential as 12-6 lennard-jones potential, presented in the paper "Theoretical investigation of the
# effect of graphite interlayer spacing on hydrogen absorption" by Rachel S. Aga, C. L. Fu, Maja Krčmar, and James R. Morris.
variable epsilon_sub equal 4*0.085094 # kcal/mol
variable sigma equal 2.97 # Å

pair_coeff 1 2 cb ${epsilon_sub} ${sigma} ${P_par} ${P_perp} # C-H potential
pair_coeff 1 2 cb 0.340376 ${sigma} ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 ${P_par} ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 0.57 ${P_perp} 
pair_coeff 1 2 cb 0.340376 2.97 0.57 1.995 
#pair_coeff 1 2 lj/cut 0.3025 2.065
# //////////////////////////////////////    C-H potentials    //////////////////////////////////////

# 4. Generate the initial hydrogen atoms
lattice sc 3
Lattice spacing in x,y,z = 3 3 3
create_atoms 2 box ratio 0.01 428795
Created 8 atoms
  using lattice units in orthogonal box = (-12.5 -12.5 -15) to (12.5 12.5 15)
  create_atoms CPU = 0.001 seconds
lattice none 1
# Print the number of hydrogen atoms to file and delete the overlapping hydrogen atoms generated
variable hydrogen atom "type==2"
group hydrogen dynamic all var hydrogen
dynamic group hydrogen defined
variable nH equal count(hydrogen)
fix myat1 all ave/time 100 10 1000 v_nH file simulation_data/hydrogenCount.data

group           C type 1
64 atoms in group C
group           H2 type 2
8 atoms in group H2
delete_atoms    overlap 4 H2 C
System init for delete_atoms ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  5 neighbor lists, perpetual/occasional/extra = 4 1 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin
      stencil: full/bin/3d
      bin: standard
  (2) pair lj/cut, perpetual, skip trim from (5)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair sg, perpetual, skip trim from (5)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (4) pair cb, perpetual, skip from (5)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (5) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Ignoring 'compress yes' for molecular system (src/delete_atoms.cpp:141)
Deleted 0 atoms, new total = 72
reset_atoms     id sort yes
Resetting atom IDs ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 3 steps, check = yes
  max neighbors/atom: 6000, page size: 100000
  master list distance cutoff = 31
  ghost atom cutoff = 31
  binsize = 15.5, bins = 2 2 2
  4 neighbor lists, perpetual/occasional/extra = 4 0 0
  (1) pair lj/cut, perpetual, skip trim from (4)
      attributes: half, newton on, cut 15
      pair build: skip/trim
      stencil: none
      bin: none
  (2) pair sg, perpetual, skip trim from (4)
      attributes: half, newton on, cut 16
      pair build: skip/trim
      stencil: none
      bin: none
  (3) pair cb, perpetual, skip from (4)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (4) neighbor class addition, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    18 = max # of 1-4 neighbors
    18 = max # of special neighbors
  special bonds CPU = 0.001 seconds

# Constrain carbon atoms
fix             myspr C spring/self 5

# 5. Equilibration step
thermo 1000
variable        T equal 298
velocity        all create ${T} 1234567 dist gaussian
velocity        all create 298 1234567 dist gaussian
#----------------------------------------------------------------
compute_modify thermo_temp dynamic yes
compute ctH2 H2 temp
compute_modify ctH2 dynamic yes
fix mynvt1 H2 nvt temp ${T} ${T} 0.1
fix mynvt1 H2 nvt temp 298 ${T} 0.1
fix mynvt1 H2 nvt temp 298 298 0.1
fix_modify mynvt1 temp ctH2
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
compute ctC C temp
fix mynvt2 C nvt temp ${T} ${T} 0.1
fix mynvt2 C nvt temp 298 ${T} 0.1
fix mynvt2 C nvt temp 298 298 0.1
fix_modify mynvt2 temp ctC
WARNING: Temperature for fix modify is not for group all (src/fix_nh.cpp:1399)
timestep 0.05
thermo_style custom step temp pe ke etotal press vol
#----------------------------------------------------------------
# fix             npt1 mob_atoms npt temp ${T} ${T} 200 iso 113 113 2000


# Fix the motion of the outer carbons

dump            test_dump all atom 100 simulation_data/test.lammpstrj

run 10000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282–-3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 13.31 | 13.52 | 13.96 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
         0   298            1818.394       63.067979      1881.462       135.64934      18750        
      1000   281.38702      1725.828       59.55205       1785.38        1000.5312      18750        
      2000   325.62193      1725.3224      68.913816      1794.2362     -757.30003      18750        
      3000   284.13133      1737.3864      60.132848      1797.5192     -159.17446      18750        
      4000   310.34726      1719.4747      65.681122      1785.1558      8.6254395      18750        
      5000   283.50675      1733.1439      60.000663      1793.1446      284.51807      18750        
      6000   261.74506      1737.5022      55.395074      1792.8972     -145.37047      18750        
      7000   244.93348      1725.8224      51.837114      1777.6595     -365.19195      18750        
      8000   263.07467      1721.3333      55.676469      1777.0098      326.66382      18750        
      9000   289.99383      1725.0149      61.373573      1786.3885     -31.142886      18750        
     10000   308.71124      1721.3113      65.334879      1786.6461      415.16161      18750        
Loop time of 2.58104 on 6 procs for 10000 steps with 72 atoms

Performance: 16.737 ns/day, 1.434 hours/ns, 3874.409 timesteps/s, 278.957 katom-step/s
96.4% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.16235    | 0.5243     | 1.2977     |  53.2 | 20.31
Bond    | 0.0014072  | 0.05912    | 0.12527    |  19.3 |  2.29
Neigh   | 0.0039174  | 0.0041999  | 0.0044804  |   0.4 |  0.16
Comm    | 0.76514    | 1.5608     | 1.9441     |  31.9 | 60.47
Output  | 0.0036315  | 0.0043874  | 0.0065088  |   1.5 |  0.17
Modify  | 0.36859    | 0.39029    | 0.42744    |   4.1 | 15.12
Other   |            | 0.03797    |            |       |  1.47

Nlocal:             12 ave          20 max           1 min
Histogram: 2 0 0 0 0 0 1 1 0 2
Nghost:           1545 ave        1664 max        1354 min
Histogram: 2 0 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 10.444444
Neighbor list builds = 23
Dangerous builds = 0

# 6. Production step - GCMC
variable tfac equal 3.0/3.0
# variable xlo equal xlo+0.1
# variable xhi equal xhi-0.1
# variable ylo equal ylo+0.1
# variable yhi equal yhi-0.1
# variable zlo equal zlo+0.1
# variable zhi equal zhi-0.1
# region system block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
fix fgcmc H2 gcmc 100 100 0 2 65899 ${T} -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 #region system
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert ${tfac} group H2     pressure 113 
fix fgcmc H2 gcmc 100 100 0 2 65899 298 -0.5 0.1     tfac_insert 1 group H2     pressure 113 
run 40000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:544)
0 atoms in group FixGCMC:gcmc_exclusion_group:fgcmc
Per MPI rank memory allocation (min/avg/max) = 14.31 | 14.52 | 14.96 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
     10000   308.71124      1721.3113      65.334879      1786.6461      415.16161      18750        
     11000   314.69632      1712.2623      83.486447      1795.7488      444.7075       18750        
     12000   292.10724      1730.1616      79.235173      1809.3968     -269.57259      18750        
     13000   297.29577      1715.2899      81.528764      1796.8187     -179.60013      18750        
     14000   301.91302      1708.2703      84.594864      1792.8651      240.13173      18750        
     15000   295.41854      1719.1221      85.416894      1804.539       540.46408      18750        
     16000   280.58754      1721.8505      75.274034      1797.1245      307.23656      18750        
     17000   332.31547      1710.5696      99.056931      1809.6266      153.26942      18750        
     18000   332.19926      1730.232       90.110283      1820.3423      44.285591      18750        
     19000   265.27528      1710.3471      71.956906      1782.304       2.4361518      18750        
     20000   276.93976      1720.4116      70.16791       1790.5796      764.84464      18750        
     21000   285.39074      1715.9833      74.861211      1790.8445     -709.5621       18750        
     22000   346.99418      1718.8612      99.295078      1818.1563      140.25951      18750        
     23000   336.45629      1714.0533      99.288318      1813.3416     -621.88201      18750        
     24000   324.95766      1724.6529      82.33415       1806.9871      736.9027       18750        
     25000   289.98223      1712.8456      78.658757      1791.5044     -284.45743      18750        
     26000   261.30529      1721.7184      75.553438      1797.2718      449.59358      18750        
     27000   284.36804      1735.6306      81.374123      1817.0048     -365.66815      18750        
     28000   281.95945      1718.3387      85.72769       1804.0664     -37.99494       18750        
     29000   330.21332      1714.7046      100.39892      1815.1035      533.08653      18750        
     30000   290.07541      1726.486       85.601311      1812.0873     -186.42715      18750        
     31000   324.51362      1721.6021      88.992837      1810.5949     -45.892106      18750        
     32000   325.46968      1719.7418      89.255022      1808.9968      697.42404      18750        
     33000   305.45184      1725.5389      88.31791       1813.8568     -1233.8851      18750        
     34000   260.66039      1723.1606      69.15114       1792.3117      586.01456      18750        
     35000   327.43458      1719.5835      92.721927      1812.3054      9.5895356      18750        
     36000   299.01041      1713.0151      85.564152      1798.5793      790.56632      18750        
     37000   303.42671      1720.9035      84.114537      1805.018      -875.14602      18750        
     38000   307.10229      1732.9126      85.133465      1818.046      -600.89015      18750        
     39000   306.14273      1724.7069      86.692567      1811.3995     -91.74239       18750        
     40000   325.82757      1718.4365      87.410709      1805.8472     -225.04662      18750        
     41000   298.19671      1727.4722      78.220362      1805.6926      468.24977      18750        
     42000   307.18831      1720.5776      89.735659      1810.3132     -324.63925      18750        
     43000   312.17335      1711.3211      90.261357      1801.5824     -256.52688      18750        
     44000   281.28316      1716.4265      72.945296      1789.3718      365.35203      18750        
     45000   274.43318      1715.3539      75.259054      1790.613      -975.20224      18750        
     46000   303.01346      1723.3748      83.999978      1807.3747      697.29         18750        
     47000   308.02814      1728.0675      79.881083      1807.9486      40.973377      18750        
     48000   316.05604      1722.0631      85.731374      1807.7945     -224.37728      18750        
     49000   256.81208      1714.1788      68.895722      1783.0745      196.72204      18750        
     50000   293.10554      1719.139       77.758582      1796.8976     -588.11754      18750        
Loop time of 74.1453 on 6 procs for 40000 steps with 90 atoms

Performance: 2.331 ns/day, 10.298 hours/ns, 539.481 timesteps/s, 48.553 katom-step/s
91.6% CPU use with 6 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.5479     | 8.0592     | 13.985     | 116.3 | 10.87
Bond    | 0.011561   | 0.25772    | 0.53598    |  39.1 |  0.35
Neigh   | 0.15733    | 0.15843    | 0.1593     |   0.2 |  0.21
Comm    | 5.7977     | 11.857     | 16.536     |  98.8 | 15.99
Output  | 0.028033   | 0.031565   | 0.039899   |   2.2 |  0.04
Modify  | 53.469     | 53.519     | 53.601     |   0.8 | 72.18
Other   |            | 0.2628     |            |       |  0.35

Nlocal:             15 ave          24 max           4 min
Histogram: 2 0 0 0 0 0 0 2 1 1
Nghost:        1971.33 ave        2097 max        1763 min
Histogram: 2 0 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 8.3555556
Neighbor list builds = 40800
Dangerous builds = 0

write_data     ensemble_test.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
write_dump     all atom simulation_data/ensemble_test.lammpstrj

Total wall time: 0:01:16
